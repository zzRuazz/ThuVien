function merge(n,t){return mergeValues(n,t),n}function IsJsonString(n){try{JSON.parse(n)}catch(t){return!1}return!0}function mergeValues(n,t){return typeof n=="object"&&typeof t=="object"?mergeObjects(n,t):Array.isArray(n)&&Array.isArray(t)?mergeArrays(n,t):t===undefined?n:t}function mergeObjects(n,t){return Object.keys(t).forEach(i=>{const r=t[i],u=n[i];n[i]=mergeValues(u,r)}),n}function mergeArrays(n,t){return t.forEach((t,i)=>{n[i]=mergeValues(n[i],t)}),n}function onlyUnique(n,t,i){return i.indexOf(n)===t}function clearForm(n){$(n).find("input, textarea").val("");$(n).find("select").each((n,t)=>{t.selectedIndex=0})}function ConvertHalfStringData(n){let t=n.length,r=Math.ceil(t/2),f=t-r,u=n.substr(0,r);for(i=0;i<f;i++)u+="*";return u}class AjaxProvider{static Get(n){if(n===undefined)throw"Ajax options is required.";n.method="GET";let t=n.hasLoading;return t===undefined&&t===!0,n.beforeSend=function(){t&&PageProvider.ShowLoading()},AjaxProvider.Ajax(n)}static GetSync(n){if(n===undefined)throw"Ajax options is required.";return n.method="GET",n.async=!1,AjaxProvider.Ajax(n)}static Post(n){if(n===undefined)throw"Ajax options is required.";return n.method="POST",AjaxProvider.Ajax(n)}static PostSync(n){if(n===undefined)throw"Ajax options is required.";return n.method="POST",n.async=!1,AjaxProvider.Ajax(n)}static PostFormData(n){if(n===undefined)throw"Ajax options is required.";return n.method="POST",n.contentType=!1,n.processData=!1,AjaxProvider.Ajax(n)}static PostFormDataSync(n){if(n===undefined)throw"Ajax options is required.";return n.method="POST",n.async=!1,n.contentType=!1,n.processData=!1,AjaxProvider.Ajax(n)}static Ajax(n){if(n===undefined)throw"Ajax options is required.";n.hasLoading===undefined&&(n.hasLoading=!0);n.beforeSend=function(){n.hasLoading&&PageProvider.ShowLoading();let t=n.button;t!==undefined&&PageProvider.LoadButtonElement(t)};let t=n.success;return n.complete=function(){n.hasLoading&&PageProvider.HideLoading();let t=n.button;t!==undefined&&PageProvider.UnloadButtonElement(t)},$.ajax(n)}static Inits(){$(function(){$(document).ajaxError(function(n,t){if(t.responseText.includes("A potentially dangerous Request"))Message.ShowErrorMessage("Dữ liệu chứa các kí tự không hợp lệ");else if(t.status===401){var i=$.parseJSON(t.responseText);Message.ShowErrorMessage("Phiên làm việc của bạn đã hết hạn, đăng nhập lại");window.location.href=i.LoginUrl}else t.status===403?Message.ShowErrorMessage("Bạn không có quyền truy cập"):Message.ShowErrorMessage("Hệ thống bị lỗi, vui lòng thử lại sau");PageProvider.HideLoading()});$(document).ajaxComplete(function(){FormProvider.BindValidate();FormProvider.AppendRequiredToControl()})})}}(function(n){n.fn.dataTable.ext.errMode="none";n.fn.MainTables=function(t){return DataTableProvider.MainTables(n(this),t)};n(document).on("click","input.checkbox-header",function(){let t=n(this).prop("checked"),i=n(this).parents(".dataTables_wrapper").first().find("input.checkbox-row");i.prop("checked",t)});n(document).on("click","input.checkbox-row",function(){let i=n(this).prop("checked"),t=n(this).parents(".dataTables_wrapper").first().find("input.checkbox-header").first();if(i){let i=n(this).parents(".dataTables_wrapper").first(),r=i.find("input.checkbox-row"),u=i.find("input.checkbox-row:checked");r.length==u.length&&t.prop("checked",!0)}else t.prop("checked",!1)})})(jQuery);class DataTableProvider{static CreateTable(n,t){t===undefined&&(t={});let i=n.DataTable(t),r=n.attr("id");t.searching==!0&&($("#"+r+"_filter input").unbind(),$("#"+r+"_filter input").bind("keyup",function(n){n.keyCode==13&&(i.search(this.value).draw(),setTimeout(function(){$($.fn.dataTable.tables(!0)).DataTable().columns.adjust()},300))}),$("#"+r+"_filter input").bind("blur",function(){i.search($(this).val())}));$("#"+r+" tbody").on("dblclick","tr",function(){var n=i.row(this).data();t.dblclick!=undefined&&t.dblclick(n.Id)});i.on("user-select",function(n,t,i,r){$(r.node()).parent().hasClass("selected")&&n.preventDefault()});var u=0;i.on("preDraw",function(){u=n.parent().scrollTop()}).on("draw.dt",function(){n.parent().scrollTop(u)});return i}static MainTables(n,t){let i={lengthMenu:[[50,100,200,-1],[50,100,200,"Tất cả"]],scrollX:!0,processing:!0,scrollCollapse:!0,serverSide:!0,searching:!1,ordering:!1,info:!1,paging:!0,bFilter:!0,select:"single",language:{sProcessing:"Đang xử lý...",sLengthMenu:"Xem _MENU_ mục",sZeroRecords:"Không tìm thấy dòng nào phù hợp",sInfo:"Đang xem _START_ đến _END_ trong tổng số _TOTAL_ mục",sInfoEmpty:"Đang xem 0 đến 0 trong tổng số 0 mục",sInfoFiltered:"(được lọc từ _MAX_ mục)",sInfoPostFix:"",sSearch:"Tìm:",sUrl:"",oPaginate:{sFirst:"Đầu",sPrevious:"Trước",sNext:"Tiếp",sLast:"Cuối"},select:{rows:""}},createdRow:function(){},ajax:{type:"POST"}};return t!==undefined&&merge(i,t),i.serverSide==!0&&(i.ajax===undefined&&(i.ajax={}),i.ajax.type===undefined&&(i.ajax.type="POST"),i.ajax.dataType===undefined&&(i.ajax.dataType="json"),i.ajax.dataFilter=function(n){n=JSON.parse(n);let i={};i=n.Data;let r=n.PaginationCount,t={};return t.data=i,t.recordsFiltered=r,t.recordsTotal=r,JSON.stringify(t)}),DataTableProvider.CreateTable(n,i)}}class DateTimeProvider{static ConvertToServerDateTime(n,t){t===undefined&&(t="/");let[r,u,i]=n.split(t);if(n.indexOf(":")!==-1){let n=i.split(" ");i=n[0];let[f,e,t]=n[1].split(":");return parseInt(i)+"-"+parseInt(u)+"-"+parseInt(r)+" "+parseInt(f)+":"+parseInt(e)+(Number.isNaN(parseInt(t))?"":":"+ +parseInt(t))}return parseInt(i)+"-"+parseInt(u)+"-"+parseInt(r)}static ConvertDBTimeToClientFormat2(n){if(n){let[u,f]=n.split("T"),[e,o,s]=u.split("-"),[i,r,t]=f.split(":"),h=parseInt(i)>=10?parseInt(i):"0"+parseInt(i),c=parseInt(r)>=10?parseInt(r):"0"+parseInt(r),l=parseInt(t)>=10?parseInt(t):"0"+parseInt(t);return e+"-"+o+"-"+s+" "+h+":"+c+(Number.isNaN(parseInt(t))?"":":"+l)}return""}static ConvertDBTimeToClientFormat(n){if(n){let[u,f]=n.split("T"),[e,o,s]=u.split("-"),[i,r,t]=f.split(":"),h=parseInt(i)>=10?parseInt(i):"0"+parseInt(i),c=parseInt(r)>=10?parseInt(r):"0"+parseInt(r),l=parseInt(t)>=10?parseInt(t):"0"+parseInt(t);return h+":"+c+(Number.isNaN(parseInt(t))?"":":"+l)+" "+s+"/"+o+"/"+e}return""}static ConvertDBTimeToDateFormatOnly(n){if(n){let[t]=n.split("T");return t}return""}static ConvertToClientFormat(n,t){t===undefined&&(t="/");let[i,r,u]=n.split(t);if(n.indexOf(":")!==-1){let n=i.split(" ");i=n[0];let[f,e,t]=n[1].split(":");return parseInt(u)+"/"+parseInt(r)+"/"+parseInt(i)+" "+parseInt(f)+":"+parseInt(e)+(Number.isNaN(parseInt(t))?"":":"+ +parseInt(t))}return parseInt(u)+"/"+parseInt(r)+"/"+parseInt(i)}static ValidateDateTime(n,t){n=n.trim();t===undefined&&(t="/");let[i,r,u]=n.split(t);if((i=parseInt(i),isNaN(i)||i>31||i<0)||(r=parseInt(r),isNaN(r)||r>12||r<0)||r===2&&i>29||i===31&&[2,4,6,9,11].indexOf(r)>-1)return!1;let s=u.split(" ");if(u=parseInt(s[0]),isNaN(u)||u<1700||u<0)return!1;let f=s[1];if(f===""||f===null||f===undefined)return!0;if(f.indexOf(":")===-1)return!1;let[e,o]=f.split(":");return(e=parseInt(e),isNaN(e)||e>23||e<0)?!1:(o=parseInt(o),isNaN(o)||o>59||o<0)?!1:!0}static ConvertToClient(n,t,i){if(n!=null&&n.length>0){let r=new Date(n.match(/\d+/).map(Number)[0]),u=r.getDate();u.toString().length===1&&(u="0"+u);let f=r.getMonth()+1;f.toString().length===1&&(f="0"+f);let e=r.getFullYear();if(t===undefined&&(t="/"),i!==undefined&&i===!0){let n=r.getHours();n.toString().length==1&&(n="0"+n);let i=r.getMinutes();i.toString().length==1&&(i="0"+i);let o=r.getSeconds();return o.toString().length==1&&(o="0"+o),u+t+f+t+e+" "+n+":"+i+":"+o}return u+t+f+t+e}}static ConvertToClientDate(n){return new Date(n.match(/\d+/).map(Number)[0])}static SubDateTime(n,t){return new Date(t.match(/\d+/).map(Number)[0])-new Date(n.match(/\d+/).map(Number)[0])}static Inits(){$('[data-type="date"].init').each(function(){let n=$(this);n.removeClass("init");n.datepicker({autoclose:!0,format:"dd/mm/yyyy",todayBtn:!0})})}}$(function(){DateTimeProvider.Inits()});$(document).ajaxComplete(function(){DateTimeProvider.Inits()});class FormProvider{static BindToFormData(n){let t=new FormData;return $.each(n.find("[name]"),function(n,i){let r=$(i),u=r.attr("name"),f=r.val();if(r.attr("data-plugin")==="summernote")t.append(u,r.summernote("code"));else if(r.attr("data-plugin")==="ckeditor")t.append(u,CKEDITOR.instances[u].getData());else if(r.attr("data-type")==="date"||r.attr("data-type")==="datetime")f!==""&&f!==null&&f!==undefined&&t.append(u,DateTimeProvider.ConvertToServerDateTime(f));else if(r.attr("data-input-type")==="number")f!==""&&f!==null&&f!==undefined?t.append(u,f.replace(/\,/g,"")):t.append(u,f);else if(r.attr("type")==="checkbox")t.append(u,r.prop("checked"));else if(r.attr("data-file")==="1"){let i=Dropzone.forElement("#"+u),n=i.files;n.length>0&&n[0]!==undefined&&t.append(u+".File",n[0])}else if(r.attr("data-file")==="2"){let i=Dropzone.forElement("#"+u),n=i.files;if(n.length>0)for(var e=0;e<n.length;e++)t.append(u+"["+e+"].File",n[e])}else r.is("select")&&r.attr("multiple")==="multiple"?$.each(f,function(n,i){t.append(u+"["+n+"]",i)}):t.append(u,f)}),t}static BindToModel(n){let t={};return $.each(n.find("[name]"),function(n,i){let r=$(i),f=r.attr("name"),u=r.val();t[f]=r.attr("data-plugin")==="summernote"?r.summernote().code():r.attr("data-plugin")==="ckeditor"?CKEDITOR.instances[f].getData():r.attr("data-type")==="date"||r.attr("data-type")==="datetime"?u!==""&&u!==null&&u!==undefined?DateTimeProvider.ConvertToServerDateTime(u):null:r.attr("data-input-type")==="number"?u!==""&&u!==null&&u!==undefined?u.replace(/\,/g,""):u:r.attr("type")==="checkbox"?r.prop("checked"):u}),t}static bindToForm(n,t){(t===undefined||t===null)&&(t={});$.each(n.find("[name]"),function(n,i){let r=$(i),f=r.attr("name"),u=t[f];if(r.attr("data-plugin")==="summernote")r.summernote("code",u);else if(r.is("select")&&r.attr("multiple")){let n=r.prev("input[type='hidden']");if(n.length>0){let t=JSON.parse(n.first().val());r.val(t)}r.change()}else r.val(u)})}static BindValidate(){var n=$("form");if(n.length>0){n.unbind();n.data("validator",null);$.validator.unobtrusive.parse(document);let t=n.data("unobtrusiveValidation");t!==undefined&&n.validate(t.options)}}static CheckBox(n,t,i="",r=""){return`<label class="rememberme mt-checkbox mt-checkbox-outline">
                    <input class="icheck" type="checkbox" name="${n}" data-value="${i}" ${r}> ${t}
                    <span></span>
                </label>`}static GenerateSelectHTML(n,t,i=false,r=true,u,f=true){let e="";u!==undefined&&u!==""&&(e=f?"<option value='' disabled='disabled'>"+u+"<\/option>":"<option value=''>"+u+"<\/option>");$.each(t,function(n,t){e+=`<option value='${t.Value}'>${t.Text}</option>`});r?n.html(e):n.append(e);i&&FormProvider.BindSelectValue(n)}static GenerateFormSelectHTML(n){return new Promise(function(t){n.find("a[data-selector='cms-select-refresh']").click();t()})}static BindMultipleSelectValue(n){n.val(JSON.parse(n.prev("input").first().val()))}static BindSelectValue(n){n.val(n.prev("input").first().val())}static GetTextareCaret(n){var i,t,r;return n.selectionStart?n.selectionStart:document.selection?(n.focus(),i=document.selection.createRange(),i===null)?0:(t=n.createTextRange(),r=t.duplicate(),t.moveToBookmark(i.getBookmark()),r.setEndPoint("EndToStart",t),r.text.length):0}static Inits(){$("body").on("submit","form",function(){return!1});$("body").on("keyup",'[data-control="1"]:not(textarea)',function(n){if(n.keyCode===13){n.preventDefault();let t=$(this).parents("form");if(t.length>0){let n=t.first().find('[data-submit="1"]');n.length&&n.first().click()}}});$("body").on("keyup",'textarea[data-control="1"]:not(.note-codable):not([data-plugin="summernote"])',function(n){if(n.keyCode===13){var t=this.value,i=FormProvider.GetTextareCaret(this);if(n.shiftKey)this.value=t.substring(0,i-1)+"\n"+t.substring(i,t.length),n.stopPropagation();else{this.value=t.substring(0,i-1)+t.substring(i,t.length);let n=$(this).parents("form");if(n.length>0){let t=n.first().find('button[data-submit="1"]');t.length&&t.first().click()}}}});$("body").on("click","a[data-selector='cms-select-refresh']",function(){let t=$(this),i=t.parents("form").first(),n=i.find("#"+t.prev("label").attr("for"));n!==undefined&&AjaxProvider.Get({url:t.attr("data-url"),success:function(t){if(t.status===200){let i=n.val();FormProvider.GenerateSelectHTML(n,t.data);let r=n.prev("input[type='hidden']");i===null||i===""||i===undefined?i=r.val():r.val(i);i!==null&&i!==""&&i!==undefined&&(n.attr("multiple")==="multiple"?FormProvider.BindMultipleSelectValue(n):FormProvider.BindSelectValue(n),n.find('option[value="'+i+'"]').length>0?n.val(i):n.val($(n.find("option")[0]).val()),n.change())}}})});$("body").on("input change keyup focusout",'[data-control="1"]:not([data-plugin="summernote"])',function(){FormProvider.ValidateControl($(this))});FormProvider.BindValidate();FormProvider.AppendRequiredToControl()}static ValidateControl(n){var t,i,r,u;if(n.attr("data-file")||n.valid()){t=n;i=t.val();let o=t.attr("name"),c=n.parents("form").first().find("label[for='"+o+"']"),f=[];r=new RegExp("<\/?[A-Za-z]+>?");r.test(i)&&f.push("Dữ liệu chứa kí tự không hợp lệ");let s=t.attr("data-type");(s==="date"||s==="datetime")&&i!==""&&i!==null&&(DateTimeProvider.ValidateDateTime(i)||f.push("Định dạng không hợp lệ"));let h=t.attr("data-file");if(h){let n=t.attr("data-val-required");n&&t.find(".dropzone-items").first().children().length==0&&f.push(n)}let e=t.parents(".form-group").first().find(".field-validation-valid[data-valmsg-for='"+o+"'], .field-validation-error").first();return f.length>0?(u=f.join("<br />"),e.html(u),e.addClass("field-validation-error"),!1):(e.html(""),e.removeClass("field-validation-error"),!0)}return!1}static Validate(n){var t=!0,i;return n.valid()||(n.find(".input-validation-error:visible").first().focus(),t=!1),i=n.find("[data-file]"),i.length>0&&$.each(i,function(n,i){FormProvider.ValidateControl($(i))||(t=!1)}),t}static AppendRequiredToControl(){var n=$('[data-val="true"]:not(.added-required-simple)');$.each(n,function(t,i){let r=$(i),u=r.attr("data-val-required");u!==undefined&&u!==""&&u!==null&&n.parents("form").first().find('label[for="'+r.attr("name")+'"]').append("<span style='color: red;margin-left: 2px;'>*<\/span>");r.addClass("added-required-simple")})}static CreateModal(n,t){$("#"+n).length&&$("#"+n).remove();$("body").append(t);return $("#"+n)}static CreateSlug(n){return n=n.toLowerCase(),n=n.replace(/(à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ằ|ắ|ặ|ẳ|ẵ)/g,"a"),n=n.replace(/(è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ)/g,"e"),n=n.replace(/(ì|í|ị|ỉ|ĩ)/g,"i"),n=n.replace(/(ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ờ|ớ|ợ|ở|ỡ)/g,"o"),n=n.replace(/(ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ)/g,"u"),n=n.replace(/(ỳ|ý|ỵ|ỷ|ỹ)/g,"y"),n=n.replace(/(đ)/g,"d"),n=n.replace(/([^0-9a-z-\s])/g,""),n=n.replace(/(\s+)/g,"-"),n=n.replace(/-+/g,"-"),n=n.replace(/^-+/g,""),n.replace(/-+$/g,"")}static GetCheckedRowTable(n,t=true){let r=n.find("input.checkbox-row"),i=[];return $.each(r,function(n,t){$(t).prop("checked")&&i.push($(t).val())}),i.length==0&&t&&Message.ShowErrorMessage("Không có dòng nào được chọn"),i}}$(function(){$.validator.setDefaults({ignore:".note-editor *"});FormProvider.Inits()});toastr.options.closeButton=!0;toastr.options.closeButton=!0;toastr.options.timeOut=5e3;class Message{static ShowErrorMessage(n){Message.ShowToastrMessage(n,"error")}static ShowInfoMessage(n){Message.ShowToastrMessage(n,"info")}static ShowSuccessMessage(n){Message.ShowToastrMessage(n,"success")}static ShowQuestionMessage(n){Message.ShowToastrMessage(n,"question")}static ShowWarningMessage(n){Message.ShowToastrMessage(n,"warning")}static ShowToastrMessage(n,t){t==="error"?toastr.error(n):t==="success"?toastr.success(n):t==="warning"?toastr.warning(n):t==="info"&&toastr.info(n)}static ShowConfirmMessage(n){bootbox.dialog({message:n.message,title:n.title,buttons:{success:{label:"Yes",className:"btn-primary green-meadow",callback:function(){let t=n.yes;t!==undefined&&t()}},danger:{label:"No",className:"btn-outline dark",callback:function(){let t=n.no;t!==undefined&&t()}}}})}static ShowDeleteConfirmMessage(n){Swal.fire({title:n.message,text:n.title,icon:"question",showCancelButton:!0,confirmButtonText:"Yes",cancelButtonText:"No",customClass:{confirmButton:"btn btn-danger px-7",cancelButton:"btn btn-secondary px-7"}}).then(function(t){if(t.value){let t=n.yes;t!==undefined&&t()}else if(t.dismiss==="cancel"){let t=n.no;t!==undefined&&t()}})}}class NumberProvider{static GetDisplayNumber(n){return!n&&n!==0?"":n.toString().replace(/\,/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,",")}static GetIntegerNumberFromInput(n){var t=$(n);return t.val(t.val().replace(/[^0-9]+$/g,""))}static GetDoubleNumberFromInput(n){for(var e,r=$(n),i=r.val().replace(/[^0-9\.]+$/g,""),u=0,f="",t=0;t<i.length;t++)(e=i[t],e==="."&&(u++,u>1))||(f+=i[t]);r.val(f)}static Inits(){$("body").on("keyup",'[data-control="1"][data-input-type="number"][data-type="double"]',function(){let n=$(this);NumberProvider.GetDoubleNumberFromInput(this);n.val(NumberProvider.GetDisplayNumber(n.val()))});$("body").on("keyup",'[data-control="1"][data-input-type="normal-number"]',function(){NumberProvider.GetIntegerNumberFromInput(this)});$("body").on("keyup",'[data-control="1"][data-input-type="number"][data-type="integer"]',function(){let n=$(this);NumberProvider.GetIntegerNumberFromInput(this);n.val(NumberProvider.GetDisplayNumber(n.val()))})}}$(function(){NumberProvider.Inits()});class PageProvider{static CopyToClipboard(n){n.select();document.execCommand("copy")}static CopyTextToClipboard(n){if(!navigator.clipboard)return fallbackCopyTextToClipboard(n),!0;navigator.clipboard.writeText(n).then(function(){return!0},function(){return!1})}static FallbackCopyTextToClipboard(n){var t=document.createElement("textarea"),i;t.value=n;document.body.appendChild(t);t.focus();t.select();try{i=document.execCommand("copy")}catch(r){console.error("Fallback: Oops, unable to copy",r)}return document.body.removeChild(t),i}static ShowLoading(){let n=$("[data-loading='1']");n.length===0?($("body").append("<div class='loading-overlay' data-loading='1'><span><i class='fa fa-spinner fa-spin'><\/i><\/span><\/div>"),$("[data-loading='1']").show()):n.show()}static HideLoading(){$("[data-loading='1']").remove()}static LoadButtonElement(n){let t=$(n);t.length>0&&(t.prepend(`<span class="spinner"><i class='fa fa-spinner fa-spin'></i></span> `),t.attr("disabled","disabled"))}static PerformClick(n){if(n&&document.createEvent){var t=document.createEvent("MouseEvents");t.initEvent("click",!0,!1);n.dispatchEvent(t)}}static UnloadButtonElement(n){let t=$(n);t.length>0&&(t.find("span.spinner").remove(),t.removeAttr("disabled"))}static GetQueryString(n){return new URLSearchParams(window.location.search).get(n)}}$(function(){AjaxProvider.Inits();$.validator.methods.date=function(){return!0};$.validator.methods.number=function(){return!0};$(".modal").on("shown.bs.modal",function(){let t=$(this),n=t.find("[data-control]:visible");n.length>0&&n.first().focus()});$(document).on("shown.bs.modal",".modal",function(){$($.fn.dataTable.tables(!0)).DataTable().columns.adjust()});$(document).on("hidden.bs.modal",".modal",function(){});$(document).on("shown.bs.tab",'[data-toggle="tab"]',function(){var n=$(this);let t=n.attr("href");$.each($(t).find("table"),function(n,t){$.fn.DataTable.isDataTable($(t))&&$(t).DataTable().columns.adjust()})})});class Select2Provider{static Inits(){var n=$('[data-plugin="select2"].init');n.length>0&&$.each(n,function(n,t){let i=$(t);i.select2();i.removeClass("init")})}}$(function(){Select2Provider.Inits()});$(document).ajaxComplete(function(){Select2Provider.Inits()});